<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kajetanek z czatem </title>
    <style>
        :root {
            --primary: #6366f1; --primary-dark: #4f46e5;
            --success: #10b981; --danger: #ef4444; --warning: #f59e0b;
            --bg: #0f172a; --card: #1e293b; --border: #334155;
            --text-main: #f8fafc; --text-dim: #94a3b8;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: 'Inter', -apple-system, sans-serif; 
            background: var(--bg); color: var(--text-main); 
            display: flex; height: 100vh; overflow: hidden;
        }

        /* SIDEBAR */
        aside { 
            width: 280px; background: #020617; border-right: 1px solid var(--border); 
            display: flex; flex-direction: column; padding: 25px; flex-shrink: 0;
        }
        .brand { font-size: 1.5rem; font-weight: 800; color: var(--primary); margin-bottom: 35px; }
        .nav-group { flex-grow: 1; }
        .nav-item { 
            padding: 14px 18px; margin: 6px 0; border-radius: 10px; cursor: pointer; 
            transition: all 0.2s; display: flex; align-items: center; gap: 12px;
            color: var(--text-dim); font-weight: 500;
        }
        .nav-item:hover { background: #1e293b; color: white; }
        .nav-item.active { background: var(--primary); color: white; }

        /* MAIN CONTENT */
        main { flex-grow: 1; padding: 40px; overflow-y: auto; background: radial-gradient(at top right, #1e1b4b, #0f172a); }
        .view { display: none; }
        .view.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* CARDS & GRIDS */
        .header-stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 35px; }
        .stat-card { background: var(--card); padding: 25px; border-radius: 16px; border: 1px solid var(--border); }
        .stat-card span { color: var(--text-dim); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; }
        .stat-card h2 { font-size: 1.8rem; margin-top: 8px; color: var(--primary); }

        .content-grid { display: grid; grid-template-columns: 1fr 350px; gap: 25px; }
        .panel { background: var(--card); border-radius: 16px; padding: 25px; border: 1px solid var(--border); margin-bottom: 25px; }

        /* TABLES */
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th { text-align: left; padding: 15px; border-bottom: 1px solid var(--border); color: var(--text-dim); font-size: 0.85rem; }
        td { padding: 15px; border-bottom: 1px solid var(--border); font-size: 0.95rem; }
        .low-stock { color: var(--danger); font-weight: bold; background: rgba(239, 68, 68, 0.1); }

        /* INPUTS & BUTTONS */
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 6px; font-size: 0.9rem; color: var(--text-dim); }
        input, select, textarea { 
            width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border);
            background: #0f172a; color: white; outline: none; transition: 0.2s;
        }
        input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2); }
        .btn { 
            padding: 12px 24px; border-radius: 8px; border: none; cursor: pointer;
            font-weight: 600; transition: 0.2s; width: 100%;
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-1px); }

        /* NOTIFICATIONS (TOASTS) */
        #toast-container { position: fixed; bottom: 30px; right: 30px; z-index: 999; }
        .toast { background: white; color: black; padding: 16px 24px; border-radius: 12px; margin-top: 10px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.3); border-left: 6px solid var(--primary); animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }

        /* TERMINAL */
        #term-out { background: #000; font-family: 'Consolas', monospace; height: 180px; overflow-y: auto; padding: 15px; color: #10b981; font-size: 0.85rem; border: 1px solid var(--border); border-radius: 8px; }
    </style>
</head>
<body>

<aside>
    <div class="brand">Kajetanek ETP</div>
    <div class="nav-group">
        <div class="nav-item active" onclick="Router.go('dash', this)"><span>ðŸ“Š</span> Dashboard</div>
        <div class="nav-item" onclick="Router.go('inv', this)"><span>ðŸ“¦</span> Magazyn</div>
        <div class="nav-item" onclick="Router.go('crm', this)"><span>ðŸ‘¥</span> Kontrahenci</div>
        <div class="nav-item" onclick="Router.go('term', this)"><span>ðŸ’»</span> Terminal AI</div>
        <div class="nav-item" onclick="Router.go('settings', this)"><span>ðŸ› </span> System</div>
    </div>
    <div style="font-size: 0.7rem; color: var(--text-dim);">Enterprise License: Active</div>
</aside>

<main>
    <div id="view-dash" class="view active">
        <div class="header-stats">
            <div class="stat-card"><span>Suma AktywÃ³w</span><h2 id="st-assets">0.00 PLN</h2></div>
            <div class="stat-card"><span>Produkty</span><h2 id="st-qty">0</h2></div>
            <div class="stat-card"><span>Klienci</span><h2 id="st-clients">0</h2></div>
            <div class="stat-card"><span>Zysk Operacyjny</span><h2 id="st-profit">0.00 PLN</h2></div>
        </div>
        
        <div class="content-grid">
            <div class="panel">
                <h3>Ostatnie Logi Finansowe</h3>
                <div id="financial-logs"></div>
            </div>
            <div class="panel">
                <h3>Szybkie DziaÅ‚ania</h3>
                <button class="btn btn-primary" onclick="Core.exportData()">Eksportuj Raport JSON</button>
            </div>
        </div>
    </div>

    <div id="view-inv" class="view">
        <div class="content-grid">
            <div class="panel">
                <h3>Zasoby Magazynowe</h3>
                <input type="text" id="inv-search" onkeyup="Inventory.search()" placeholder="Szukaj produktu...">
                <table>
                    <thead><tr><th>ID</th><th>Nazwa</th><th>Cena Zakupu</th><th>Cena SprzedaÅ¼y</th><th>IloÅ›Ä‡</th></tr></thead>
                    <tbody id="table-inventory"></tbody>
                </table>
            </div>
            <div class="panel">
                <h3>Nowy Produkt</h3>
                <div class="form-group"><label>Nazwa Produktu</label><input type="text" id="p-name"></div>
                <div class="form-group"><label>Cena Zakupu (Netto)</label><input type="number" id="p-buy"></div>
                <div class="form-group"><label>Cena SprzedaÅ¼y (Brutto)</label><input type="number" id="p-sell"></div>
                <div class="form-group"><label>Stan poczÄ…tkowy</label><input type="number" id="p-qty"></div>
                <button class="btn btn-primary" onclick="Inventory.add()">Dodaj do bazy</button>
            </div>
        </div>
    </div>

    <div id="view-crm" class="view">
        <div class="panel">
            <h3>Baza KontrahentÃ³w</h3>
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <input type="text" id="cli-name" placeholder="Nazwa firmy">
                <input type="text" id="cli-nip" placeholder="NIP">
                <button class="btn btn-primary" style="width: 200px;" onclick="CRM.add()">Zapisz Klienta</button>
            </div>
            <table>
                <thead><tr><th>Data Rejestracji</th><th>Nazwa Firmy</th><th>Identyfikator NIP</th><th>Status</th></tr></thead>
                <tbody id="table-crm"></tbody>
            </table>
        </div>
    </div>

    <div id="view-term" class="view">
        <div class="panel">
            <h3>Konsola Systemowa (Internal Core)</h3>
            <div id="term-out"></div>
            <input type="text" id="term-in" placeholder="Wpisz komendÄ™ (help / stats / clear / backup)..." onkeydown="if(event.key==='Enter') Terminal.exec(this.value)">
        </div>
    </div>

    <div id="view-settings" class="view">
        <div class="panel">
            <h3>Konfiguracja Systemu</h3>
            <p style="margin-bottom: 20px; color: var(--text-dim);">ZarzÄ…dzanie twardym restartem bazy danych i ustawieniami licencji.</p>
            <button class="btn" style="background: var(--danger); color: white;" onclick="Core.reset()">TWARDY RESET BAZY DANYCH</button>
        </div>
    </div>
</main>

<div id="toast-container"></div>

<script>
/**
 * AETHER ERP ENTERPRISE CORE ENGINE
 * Wersja: 8.0.0
 * Architektura: Modular Object-Oriented
 */

const Core = {
    data: {
        inventory: [],
        clients: [],
        logs: []
    },

    init() {
        this.load();
        this.renderAll();
        this.log("Inicjalizacja systemu zakoÅ„czona pomyÅ›lnie.");
        this.toast("Witaj w Aether ERP Enterprise");
    },

    load() {
        const saved = localStorage.getItem('ae_enterprise_v8');
        if(saved) this.data = JSON.parse(saved);
    },

    save() {
        localStorage.setItem('ae_enterprise_v8', JSON.stringify(this.data));
    },

    log(msg) {
        const entry = { time: new Date().toLocaleTimeString(), msg };
        this.data.logs.push(entry);
        if(this.data.logs.length > 50) this.data.logs.shift();
        this.save();
        this.renderLogs();
    },

    toast(msg) {
        const container = document.getElementById('toast-container');
        const t = document.createElement('div');
        t.className = 'toast';
        t.innerText = msg;
        container.appendChild(t);
        setTimeout(() => t.remove(), 3000);
    },

    renderAll() {
        Inventory.render();
        CRM.render();
        this.renderDash();
        this.renderLogs();
    },

    renderDash() {
        const totalAssets = this.data.inventory.reduce((a, b) => a + (b.buyPrice * b.qty), 0);
        const totalQty = this.data.inventory.reduce((a, b) => a + b.qty, 0);
        const profit = this.data.inventory.reduce((a, b) => a + ((b.sellPrice - b.buyPrice) * b.qty), 0);

        document.getElementById('st-assets').innerText = totalAssets.toFixed(2) + " PLN";
        document.getElementById('st-qty').innerText = totalQty;
        document.getElementById('st-clients').innerText = this.data.clients.length;
        document.getElementById('st-profit').innerText = profit.toFixed(2) + " PLN";
    },

    renderLogs() {
        const container = document.getElementById('financial-logs');
        if(!container) return;
        container.innerHTML = this.data.logs.slice(-5).map(l => `
            <div style="padding: 10px; border-bottom: 1px solid var(--border); font-size: 0.85rem;">
                <span style="color: var(--primary)">[${l.time}]</span> ${l.msg}
            </div>
        `).reverse().join('');
    },

    exportData() {
        const blob = new Blob([JSON.stringify(this.data, null, 2)], {type: 'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `Aether_Backup_${new Date().toISOString().slice(0,10)}.json`;
        a.click();
        this.toast("Pobrano kopiÄ™ bazy danych.");
    },

    reset() {
        if(confirm("Czy na pewno chcesz usunÄ…Ä‡ WSZYSTKIE dane? Nie moÅ¼na tego cofnÄ…Ä‡.")) {
            localStorage.clear();
            location.reload();
        }
    }
};

const Router = {
    go(viewId, btn) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById('view-' + viewId).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        btn.classList.add('active');
        Core.log("Nawigacja: ModuÅ‚ " + viewId);
    }
};

const Inventory = {
    add() {
        const name = document.getElementById('p-name').value;
        const buy = parseFloat(document.getElementById('p-buy').value);
        const sell = parseFloat(document.getElementById('p-sell').value);
        const qty = parseInt(document.getElementById('p-qty').value);

        if(!name || isNaN(buy) || isNaN(sell)) {
            Core.toast("BÅ‚Ä…d: NiepeÅ‚ne dane produktu!");
            return;
        }

        const product = {
            id: 'ID-' + Math.random().toString(36).substr(2, 4).toUpperCase(),
            name, buyPrice: buy, sellPrice: sell, qty
        };

        Core.data.inventory.push(product);
        Core.save();
        this.render();
        Core.renderDash();
        Core.log("Magazyn: Dodano produkt " + name);
        Core.toast("Produkt dodany do magazynu.");

        // Clear
        ['p-name', 'p-buy', 'p-sell', 'p-qty'].forEach(id => document.getElementById(id).value = '');
    },

    render(filter = "") {
        const tbody = document.getElementById('table-inventory');
        const items = Core.data.inventory.filter(i => i.name.toLowerCase().includes(filter.toLowerCase()));
        
        tbody.innerHTML = items.map(i => `
            <tr class="${i.qty < 5 ? 'low-stock' : ''}">
                <td>${i.id}</td>
                <td>${i.name}</td>
                <td>${i.buyPrice.toFixed(2)}</td>
                <td>${i.sellPrice.toFixed(2)}</td>
                <td>${i.qty} ${i.qty < 5 ? '(Niski stan!)' : ''}</td>
            </tr>
        `).join('');
    },

    search() {
        const q = document.getElementById('inv-search').value;
        this.render(q);
    }
};

const CRM = {
    add() {
        const name = document.getElementById('cli-name').value;
        const nip = document.getElementById('cli-nip').value;

        if(!name) return Core.toast("BÅ‚Ä…d: Nazwa firmy jest wymagana!");

        const client = {
            id: Date.now(),
            date: new Date().toLocaleDateString(),
            name, nip, status: 'Active'
        };

        Core.data.clients.push(client);
        Core.save();
        this.render();
        Core.renderDash();
        Core.log("CRM: Zarejestrowano kontrahenta " + name);
        Core.toast("Klient zapisany pomyÅ›lnie.");

        document.getElementById('cli-name').value = '';
        document.getElementById('cli-nip').value = '';
    },

    render() {
        const tbody = document.getElementById('table-crm');
        tbody.innerHTML = Core.data.clients.map(c => `
            <tr>
                <td>${c.date}</td>
                <td><b>${c.name}</b></td>
                <td>${c.nip || 'Brak NIP'}</td>
                <td style="color: var(--success)">Aktywny</td>
            </tr>
        `).reverse().join('');
    }
};

const Terminal = {
    exec(cmd) {
        const out = document.getElementById('term-out');
        const input = document.getElementById('term-in');
        let response = "";

        const command = cmd.toLowerCase().trim();

        if(command === 'help') {
            response = "DostÄ™pne komendy: HELP, STATS, CLEAR, BACKUP, VERSION";
        } else if(command === 'stats') {
            response = `System Status: OK. Produkty: ${Core.data.inventory.length}, Klienci: ${Core.data.clients.length}`;
        } else if(command === 'version') {
            response = "Aether ERP Enterprise v8.0.0 Stable Build.";
        } else if(command === 'clear') {
            out.innerHTML = "";
            input.value = "";
            return;
        } else if(command === 'backup') {
            Core.exportData();
            response = "Uruchomiono eksport bazy danych...";
        } else {
            response = `BÅ‚Ä…d: Nieznana komenda '${command}'. Wpisz 'help' po listÄ™ funkcji.`;
        }

        out.innerHTML += `<div><span style="color:#fff">> ${cmd}</span><br>${response}</div>`;
        out.scrollTop = out.scrollHeight;
        input.value = "";
    }
};

// INITIALIZE
window.onload = () => Core.init();
</script>
</body>
</html>